IyEvdXNyL2Jpbi9weXRob24gMwppbXBvcnQgb3MKdHJ5OgogICAgaW1wb3J0IHJlcXVlc3RzCmV4
Y2VwdDoKICAgIG9zLnN5c3RlbSAoInBpcCBpbnN0YWxsIHJlcXVlc3RzIikKdHJ5OgogICBpbXBv
cnQgY29sb3JhbWEKZXhjZXB0OgogICAgb3Muc3lzdGVtKCJwaXAgaW5zdGFsbCBjb2xvcmFtYSIp
CnRyeToKICAgIGltcG9ydCBweWZpZ2xldApleGNlcHQ6CiAgICBvcy5zeXN0ZW0oInBpcCBpbnN0
YWxsIHB5ZmlnbGV0IikKZnJvbSBjb2xvcmFtYSBpbXBvcnQgKgphdXRoID0gJzE4NDBlNTNlLTBh
OGItNGQ0ZC1iNGU2LTRkMzRkMTAzM2Q5MSc7CmltcG9ydCB0aW1lIGFzIHQKdC5zbGVlcCgyKQpv
cy5zeXN0ZW0oImNsZWFyIikKZGVmIGxvb3AoKToKICAgIGhlYWQgPSBweWZpZ2xldC5maWdsZXRf
Zm9ybWF0KCJJcCAtIFRyYWNrZXIiKQogICAgb3Muc3lzdGVtKCJjbGVhciIpCiAgICBwcmludChG
b3JlLkdSRUVOICsgaGVhZCkKICAgIHByaW50KEZvcmUuWUVMTE9XICsgIiIiCiAgICBbK11Ub29s
IE5hbWU6SXAgVHJhY2tlcgogICAgWytdQ3JlYXRvcjpaSUhBRCBIT1NTQUlOIFJBRkkKICAgIFsr
XVRlYW06U1BFQ0lBTCBDWUJFUiBURUFNCiAgICBbK11XaGF0c2FwcDorODgwMTg0MjgyNzUyMAog
ICAgWytdR2l0aHViOmh0dHBzOi8vZ2l0aHViLmNvbS9NUi1aSUhBRAogICAgWytdQ3JlZGl0IGdv
ZXMgdG8gWklIQUQgSE9TU0FJTiBSQUZJCiAgICBbK11WZXJzaW9uOiBWMS42IiIiKQogICAgcHJp
bnQoRm9yZS5CTFVFICsgIiIiID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09IiIiKQogICAgI3ByaW50KCJVc2FnZTpJcHRyYWNrZXIgW0lwIGFkZHJlc3NdXG5cbkV4
YW1wbGU6SXB0cmFja2VyIDE5Mi4xNjguMS45NSIpCiAgICBwcmludChGb3JlLkdSRUVOICsgIiIi
CiAgICBUeXBlIFwic2hvd1wiIHRvIHNob3cgYWxsIGNvbW1hbmQgCiAgICAKICAgICIiIikKICAg
IGRlZiB0cmFjaygpOgogICAgICAgIHRpcCA9IGlucHV0KEZvcmUuTUFHRU5UQSArICJJcHRyYWNr
ZXIgPiAiICsgU3R5bGUuUkVTRVRfQUxMKQogICAgICAgIGlmIHRpcCA9PSAiaGVscCI6CiAgICAg
ICAgICAgIHByaW50KEZvcmUuQkxVRSArICIiIgogICAgICAgICAgICBzaG93IDogIEl0cyBEaXNw
bGF5IGFsbCBjb21tYW5kcwogICAgICAgICAgICBpcHRyYWNrZXIgOiAgVGhpcyBpcyB1c2VkIGZv
ciB0cmFja2luZyBhbiBJcCBhZGRyZXNzCiAgICAgICAgICAgIGhlbHAgOiAgSXRzIGRpc3BsYXkg
aG93IHRvIHVzZSB0aGlzIHRvb2wKICAgICAgICAgICAgZXhpdCA6IEZvciBxdWl0dGluZyBpcCB0
cmFja2VyCiAgICAgICAgICAgIAogICAgICAgICAgICB1cGRhdGU6ICBJdHMgdXBkYXRlIElwLVRy
YWNrZXIgYXV0b21hdGljYWxseSAKICAgICAgICAgICAgIiIiKQogICAgICAgICAgICB0cmFjaygp
CiAgICAgICAgZWxpZiB0aXAgPT0gInNob3ciOgogICAgICAgICAgICBwcmludChGb3JlLkJMVUUg
KyAiIiIKICAgICAgICAgICAgVGhpcyBhcmUgdGhlIGF2YWlsYWJsZSBjb21tYW5kcwogICAgICAg
ICAgICBoZWxwCiAgICAgICAgICAgIHNob3cKICAgICAgICAgICAgZXhpdAogICAgICAgICAgICBp
cHRyYWNrZXIKICAgICAgICAgICAgdXBkYXRlCiAgICAgICAgICAgICIiIikKICAgICAgICAgICAg
dHJhY2soKQogICAgICAgIGVsaWYgdGlwID09ICJleGl0IjoKICAgICAgICAgICAgcHJpbnQoRm9y
ZS5ZRUxMT1cgKyAiVGhhbmtzIGZvciB1c2luZyBteSB0b29sXG5JZiB5b3UgZmluZCBhbnkgZXJy
b3IsZG9ub3QgaGVzdGl0YXRlIHRvIG1lc3NhZ2UgbWUgb24gd2hhdHNhcHAiKQogICAgICAgICAg
ICBleGl0KCkKICAgICAgICBlbGlmIHRpcCA9PSAiaXB0cmFja2VyIjoKICAgICAgICAgICAgcHJp
bnQoRm9yZS5HUkVFTiArICIiIl9fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fVHJhY2sg
SXBfX19fX19fX19fX19fX19fX19fX19fX19fX19fIiIiKQogICAgICAgICAgICBwcmludCgiIiIK
ICAgICAgICAgICAgIiIiKQogICAgICAgICAgICAKICAgICAgICAgICAgaXAgPSAoaW5wdXQoRm9y
ZS5ZRUxMT1cgKyBCYWNrLiBSRUQgKyAiRW50ZXIgSVAgQWRkcmVzcyA6ICIgKyBTdHlsZS5SRVNF
VF9BTEwgKyAiIikpCiAgICAgICAgICAgIHByaW50IChGb3JlLkNZQU4gKyAiIEZldGNoaW5nIGRh
dGEgZnJvbSAiICsgaXApCiAgICAgICAgICAgIGRlZiBnZXRfbG9jYXRpb24oKToKICAgICAgICAg
ICAgICAgIGlwX2FkZHJlc3MgPSBpcAogICAgICAgICAgICAgICAgcmVzcG9uc2UgPSByZXF1ZXN0
cy5nZXQoZidodHRwczovL2lwYXBpLmNvL3tpcF9hZGRyZXNzfS9qc29uLycpLmpzb24oKQogICAg
ICAgICAgICAgIAogICAgICAgICAgICAgICAgbG9jYXRpb25fZGF0YSA9IHsKICAgICAgICAgICAg
ICAgICJJcCBBZGRyZXNzIiA6IGlwX2FkZHJlc3MsIAogICAgICAgICAgICAgICAgImNpdHkiIDog
cmVzcG9uc2UuZ2V0KCJjaXR5IiksCiAgICAgICAgICAgICAgICAicmVnaW9uIiA6IHJlc3BvbnNl
LmdldCgicmVnaW9uIiksCiAgICAgICAgICAgICAgICAiY291bnRyeSIgOiByZXNwb25zZS5nZXQo
ImNvdW50cnlfbmFtZSIpLAogICAgICAgICAgICAgICAgIklwIEFkZHJlc3MgVHlwZSIgOiByZXNw
b25zZS5nZXQoInZlcnNpb24iKSwKICAgICAgICAgICAgICAgICJSZWdpb24gQ29kZSIgOiByZXNw
b25zZS5nZXQoInJlZ2lvbl9jb2RlIiksIAogICAgICAgICAgICAgICAgIlBvc3RhbCBDb2RlIiA6
IHJlc3BvbnNlLmdldCgicG9zdGFsIiksIAogICAgICAgICAgICAgICAgIkxhdGl0dWRlIiA6IHJl
c3BvbnNlLmdldChzdHIoImxhdGl0dWRlIikpLCAKICAgICAgICAgICAgICAgICJMb25naXR1ZGUi
IDogcmVzcG9uc2UuZ2V0KHN0cigibG9uZ2l0dWRlIikpLCAKICAgICAgICAgICAgICAgICJUaW1l
Wm9uZSIgOiByZXNwb25zZS5nZXQoInRpbWV6b25lIiksIAogICAgICAgICAgICAgICAgIkNvdW50
cnkgY29kZSIgOiByZXNwb25zZS5nZXQoImNvdW50cnlfY2FsbGluZ19jb2RlIiksIAogICAgICAg
ICAgICAgICAgIkN1cnJlbmN5IiA6IHJlc3BvbnNlLmdldCgiY3VycmVuY3kiKSwgCiAgICAgICAg
ICAgICAgICAiQ3VycmVuY3kgTmFtZSIgOiByZXNwb25zZS5nZXQoImN1cnJlbmN5X25hbWUiKSAs
IAogICAgICAgICAgICAgICAgIkxhbmd1YWdlcyIgOiByZXNwb25zZS5nZXQoImxhbmd1YWdlcyIp
LCAKICAgICAgICAgICAgICAgICJDb3VudHJ5IEFyZWEiIDogcmVzcG9uc2UuZ2V0KCJjb3VudHJ5
X2FyZWEiKSwgCiAgICAgICAgICAgICAgICAiUG9wdWxhdGlvbiIgOiByZXNwb25zZS5nZXQoImNv
dW50cnlfcG9wdWxhdGlvbiIpLAogICAgICAgICAgICAgICAgIkFTTiIgOiByZXNwb25zZS5nZXQo
ImFzbiIpLCAKICAgICAgICAgICAgICAgICJPcmdhbml6YXRpb24iIDogcmVzcG9uc2UuZ2V0KCJv
cmciKQogICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGxh
dGl0dWRlID0gcmVzcG9uc2UuZ2V0KCJsYXRpdHVkZSIpCiAgICAgICAgICAgICAgICBnbG9iYWwg
bGF0CiAgICAgICAgICAgICAgICBsYXQgPSBzdHIobGF0aXR1ZGUpCiAgICAgICAgICAgICAgICBs
b25naXR1ZGUgPSByZXNwb25zZS5nZXQoImxvbmdpdHVkZSIpCiAgICAgICAgICAgICAgICBnbG9i
YWwgbG9uZwogICAgICAgICAgICAgICAgbG9uZyA9IHN0cihsb25naXR1ZGUpCiAgICAgICAgICAg
ICAgICAKICAgICAgICAgICAgICAgIGdsb2JhbCB1cmwKICAgICAgICAgICAgICAgIHVybCA9ICJo
dHRwczovL2dvb2dsZS5jb20vbWFwcy9wbGFjZS8iICsgbGF0ICsgICIsIiArIGxvbmcgKyAiL0Ai
ICsgbGF0ICsgIiwiICsgbG9uZyArICIsMTZ6IgogICAgICAgIAogICAgICAgICAgICAgICAgcmV0
dXJuIGxvY2F0aW9uX2RhdGEKICAgICAgICAgICAgICAgIAoKCiAgICAgICAgICAgIHByaW50KEZv
cmUuWUVMTE9XLCBnZXRfbG9jYXRpb24oKSkKICAgICAgICAgICAgcHJpbnQoRm9yZS5ZRUxMT1cg
KyAiXG5Hb29nbGUgTWFwczogIiArIEZvcmUuR1JFRU4gKyB1cmwpCiAgICAgICAgICAgIG9wbiA9
ICJ4ZGctb3BlbiAiICsgdXJsCiAgICAgICAgICAgIG1hcCA9IGlucHV0IChGb3JlLkNZQU4gKyAi
XG5cbkRvIHlvdSB3YW50IHRvIG9wZW4gbG9jYXRpb24gb24gZ29vZ2xlIG1hcD8gW3llcy9ub106
ICIgKyBTdHlsZS5SRVNFVF9BTEwpCiAgICAgICAgICAgIGlmIG1hcCA9PSAieWVzIiBvciBtYXAg
PT0gIlllcyI6CiAgICAgICAgICAgICAgICBvcy5zeXN0ZW0ob3BuKQogICAgICAgICAgICAKICAg
ICAgICBlbGlmIHRpcCA9PSAidXBkYXRlIjoKICAgICAgICAgICAgcHJpbnQoRm9yZS5HUkVFTiAr
ICJVcGRhdGluZyBJcCBUcmFja2VyIikKICAgICAgICAgICAgb3Muc3lzdGVtKCIiIgogICAgICAg
ICAgICBjZAogICAgICAgICAgICBybSAtZiAtciBJcC1UcmFja2VyCiAgICAgICAgICAgIGdpdCBj
bG9uZSBodHRwczovL2dpdGh1Yi5jb20vTVItWklIQURBL0lwLVRyYWNrZXIKICAgICAgICAgICAg
CiAgICAgICAgICAgICIiIikKICAgICAgICAgICAgCiAgICAgICAgICAgIHByaW50KEZvcmUuQkxV
RSArICIiIk5vdyB0eXBlIHRoZSBmb2xsb3dpbmcgY29tbWFuZAogICAgICAgICAgICBjZCAkSE9N
RQogICAgICAgICAgICBjZCBJcC1UcmFja2VyCiAgICAgICAgICAgIHB5dGhvbjMgdHJhY2tlci5w
eQogICAgICAgICAgICAiIiIpCiAgICAgICAgICAgIGV4aXQoKQogICAgICAgIGVsc2U6CiAgICAg
ICAgICAgIHByaW50KEZvcmUuUkVEICsgIkludmFsaWQgQ29tbWFuZCEiKQogICAgICAgICAgICB0
LnNsZWVwKDMpCiAgICAgICAgICAgIHRyYWNrKCkKICAgIHRyYWNrKCkKICAgICAgICAgICAgCiAg
ICBjb250ID0gaW5wdXQoIlxuXG4iICsgRm9yZS5ZRUxMT1cgKyBCYWNrLiBSRUQgKyAiV291bGQg
eW91IGxpa2UgdG8gdHJhY2sgYW5vdGhlciBJUCBhZGRyZXNzPyBbeS9uXSAiICsgU3R5bGUuUkVT
RVRfQUxMICsgIiAiKQogICAgaWYgY29udCA9PSAieSIgb3IgY29udCA9PSAiWSI6CiAgICAgICAg
bG9vcCgpCiAgICBlbHNlOgogICAgICAgIGV4aXQoKQpsb29wKCk
